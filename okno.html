<!DOCTYPE html>
<html lang="pl">

<head>

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Demo - okno dialogowe</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.js"
        integrity="sha512-+k1pnlgt4F1H8L7t3z95o3/KO+o78INEcXTbnoJQ/F2VqDVhWoaiVml/OEHv9HsVgxUaVW+IbiZPUJQfF/YxZw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js"
        integrity="sha512-57oZ/vW8ANMjR/KQ6Be9v/+/h6bq9/l3f0Oc7vn6qMqyhvPd1cvKBRWWpzu0QoneImqr2SkmO4MSqU+RpHom3Q=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.3/jquery.ui.touch-punch.min.js"
        integrity="sha512-0bEtK0USNd96MnO4XhH8jhv3nyRF0eK87pJke6pkYf3cM0uDIhNJy9ltuzqgypoIFXw3JSuiy04tVk4AjpZdZw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <style>
        body {
            display: body;
            position: absolute;
            background: url(./wallpaper.jpg) bottom;
            color: #eeeeee;
            font-family: Verdana, Geneva, Tahoma, sans-serif;
            font-size: 14px;
            text-shadow: 0px 0px #00000042;
            overflow: hidden;
            width: 100%;
            height: 100%;
            margin: 0;
            justify-content: center;
            align-items: center;
        }

        .okno {
            min-width: 400px;
            height: max-content;
            width: max-content;
            background-color: #3d3d3d;
            border-radius: 5px;
            user-select: none;
            border: 1px solid #00000000;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.438);
            margin: 0;
            transition: opacity 200ms, transform 300ms;
            z-index: 1000;
            position: absolute;
        }

        .light .okno {
            background-color: #eeeeee;
            color: #111111;
        }

        .oknoActive {
            border: 1px solid #8a8a8a;
        }

        .light .oknoActive {
            border: 1px solid #1b6ac5;
        }

        .light .okno .pasek {
            background-color: #1b6ac5;
            color: white;
            border-bottom: 1px solid #397ece;
            text-shadow: 1px 1px 3px #111111;
        }

        .light .okno .pasek .button-pasek {
            box-shadow: 0px 0px 3px #111111;
        }

        .light .okno .pasek .close {
            background-color: #ec2020;
        }

        .light .okno .pasek .minimalizuj {
            background-color: #2061ec;
        }

        .pasek {
            background-color: #333333;
            border-radius: 5px 5px 0 0;
            padding: 5px 5px 5px 10px;
            margin-bottom: 5px;
            border-bottom: 1px solid #464646;
            font-weight: bold;
            font-size: 17px;
            display: inline-flex;
            width: -webkit-fill-available;
            align-items: center;
            justify-content: space-between;
        }

        .pasekBlur {
            background-color: #3d3d3d;
        }

        .light .okno .pasekBlur {
            background-color: #478ddd;
        }

        .button-pasek,
        .przycisk,
        .light .okno .przyciski .przycisk {
            width: 32px;
            border-radius: 5px;
            text-align: center;
            float: right;
            justify-content: center;
            margin-left: 2px;
            margin-right: 2px;
            color: #DFDFDF;
            display: flex;
            align-items: center;
            height: 32px;
            text-shadow: 1px 1px 3px #111111;
        }

        .przycisk,
        .light .okno .przyciski .przycisk {
            width: 100px;
            height: 30px;
            border: 1px solid rgb(78, 78, 78);
            background-color: rgb(102, 102, 102);
            margin: 5px;
        }

        .light .okno .przyciski .przycisk {
            background-color: rgb(212, 212, 212);
            color: #111111;
            font-size: 15px;
        }

        .przycisk:hover,
        .light .okno .przyciski .przycisk:hover {
            transition: background-color 0.1s;
            background-color: rgb(62, 73, 226);
            color: #eeeeee;
        }

        .przycisk:active,
        .light .okno .przyciski .przycisk:active {
            transition: background-color 0.05s;
            background-color: rgb(60, 68, 170);
            transform: scale(0.98);
        }

        .button-pasek:hover {
            transition: background-color 0.2s;
            color: #eeeeee;
        }

        .close:hover {
            background-color: rgb(218, 40, 40);
        }

        .minimalizuj:hover {
            background-color: rgb(40, 117, 218);
        }

        .button-pasek:active {
            transition: background-color 0.05s;
            color: #eeeeee;
            transform: scale(0.98);
        }

        .close:active {
            background-color: rgb(180, 34, 34);
        }

        .minimalizuj:active {
            background-color: rgb(34, 73, 180);
        }

        .content {
            padding: 20px;
            display: flex;
            align-items: center;
        }

        .przyciski {
            display: flex;
            justify-content: center;
            width: auto;
            height: 40px;
            margin-bottom: 10px;
        }

        .ikona {
            font-size: 40px;
        }

        .powiadomienie {
            display: none;
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            background-color: #333;
            color: #fff;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.438);
        }

        .pasekzadan {
            display: flex;
            align-items: center;
            position: absolute;
            left: 0px;
            top: 0px;
            background-color: #1b6ac5;
            width: 100%;
            height: 50px;
            user-select: none;
        }

        .zegar {
            display: grid;
            justify-items: flex-end;
            float: right;
            position: absolute;
            right: 10px;
        }

        button {
            user-select: none;
        }

        .przelaczniki {
            display: inline-flex;
        }

        .pasekprzyciski {
            display: flex;
        }

        .pasekprzycisk {
            background-color: #226ec5;
            border: 1px solid #245ea0;
            height: 40px;
            width: 200px;
            border-radius: 4px;
            margin-left: 5px;
            display: flex;
            align-items: center;
            padding-left: 5px;
            font-size: 16px;
            transition: all 0.1s;
        }

        .pasekprzycisk:hover {
            background-color: #3973b6;
        }

        .pasekprzycisk:active {
            background-color: #316cb1;
            transform: scale(0.98);
        }

        .pasekprzyciskactive {
            background-color: #1e5799;
            font-size: 17px;
            text-shadow: 2px 2px 5px #111111;
        }

        .active {
            z-index: 999;
        }
    </style>

    <script>
        const dlugoscAnimacji = 250;

        var zindex = 1;
        var oknoXpos = [];
        var oknoYpos = [];
        var oknoIlosc = 1;

        $(function () {
            $(".okno").draggable({ handle: ".pasek", cancel: ".button-pasek", scroll: false });
            $()
        });

        function setClickState(name, isEnabled) {
            const pointerEventsValue = isEnabled ? "auto" : "none";
            $(name).css("pointer-events", pointerEventsValue);
        }

        function closeModal(oknoId, min) {
            const $przycisk = $("#oknoprzycisk" + oknoId);
            var $blok = $("#okno" + oknoId);
            oknoIlosc--;
            $blok.css({
                "opacity": "0%",
                "transform": "scale(0.9) rotateX(20deg)"
            });
            setClickState($blok, false);
            setTimeout(function () {
                $blok.hide();
            }, dlugoscAnimacji);
            if (min != 1) {
                $przycisk.css({
                    "opacity": "0%",
                    "transform": "scale(0.9) rotateX(20deg)"
                });
                setClickState($przycisk, false);
                setTimeout(function () {
                    $przycisk.hide();
                }, dlugoscAnimacji);
            }
        }

        function openModal(oknoId, przy) {
            const $przycisk = $("#oknoprzycisk" + oknoId);
            var $blok = $("#okno" + oknoId);
            
            oknoIlosc++;
            $przycisk.css({
                "order": oknoIlosc++
            });

            $przycisk.show();

            var windowWidth = $(window).width();
            var windowHeight = $(window).height();
            var divWidth = $blok.outerWidth();
            var divHeight = $blok.outerHeight();

            var leftValue = (windowWidth - divWidth) / 2;
            var topValue = (windowHeight - divHeight) / 2;

            if (przy == 0) {
                $blok.css({
                    "left": leftValue,
                    "top": topValue
                });
                $przycisk.show();
                $przycisk.css({
                    "display": "flex"
                });
                setClickState($przycisk, true);
                setTimeout(function () {
                    $przycisk.css({
                        "opacity": "100%",
                        "transform": "scale(1) rotateX(0deg)"
                    });
                }, 1);
            }
            $blok.css({
                "display": "block"
            });
            setClickState($blok, true);
            fokus(oknoId);
            setTimeout(function () {
                $blok.css({
                    "opacity": "100%",
                    "transform": "scale(1) rotateX(0deg)"
                });
            }, 1);

            if ($blok.attr("resizable") == "true") {
                $(function () {
                    $blok.resizable({
                        minHeight: divHeight,
                        minWidth: divWidth,
                        handles: "n, e, s, w, ne, se, sw, nw",
                        autoHide: true
                    });
                })
            }
            $("#okno" + oknoId).css("z-index", zindex);
        }

        function toggleModal(oknoId, callback) {
            const $przycisk = $("#oknoprzycisk" + oknoId);
            $przycisk.toggleClass("pasekprzyciskactive");

            if (callback) {
                $przycisk.attr("onclick", callback);
            }
        }

        function przywrocModal(oknoId) {
            const $przycisk = $("#oknoprzycisk" + oknoId);
            var $blok = $("#okno" + oknoId);

            setClickState($przycisk, false);
            fokus(oknoId);
            $blok.animate({
                left: oknoXpos[oknoId],
                top: oknoYpos[oknoId]
            }, dlugoscAnimacji);
            $blok.css({
                "display": "block"
            });
            setClickState($blok, true);
            setTimeout(function () {
                $blok.css({
                    "opacity": "100%",
                    "transform": "scale(1) rotateX(0deg)"
                });
            }, 1);
            toggleModal(oknoId, "minimalizujrzycisk(" + oknoId + ")");

            setTimeout(function () {
                setClickState($przycisk, true);
            }, dlugoscAnimacji);
        }

        function minimalizujModal(oknoId) {
            const $przycisk = $("#oknoprzycisk" + oknoId);
            var $blok = $("#okno" + oknoId);

            setClickState($przycisk, false);

            oknoXpos[oknoId] = $blok.position().left;
            oknoYpos[oknoId] = $blok.position().top;

            $blok.animate({
                left: $przycisk.position().left,
                top: 0
            }, dlugoscAnimacji);
            $blok.css({
                "opacity": "0%",
                "transform": "scale(0.5)"
            });
            setClickState($blok, false);
            setTimeout(function () {
                $blok.hide();
            }, dlugoscAnimacji);
            toggleModal(oknoId, "przywrocPrzycisk(" + oknoId + ")");

            setTimeout(function () {
                setClickState($przycisk, true);
            }, dlugoscAnimacji);
        }

        function minimalizujPrzycisk(oknoId) {
            var $blok = $("#okno" + oknoId);

            if($blok.css("z-index") == zindex - 1) {
                minimalizujModal(oknoId);
                $przycisk.toggleClass("pasekprzyciskactive");
                toggleModal(oknoId, "przywrocPrzycisk(" + oknoId + ")");
                fokus(oknoId);
            }
            else {
                fokus(oknoId);
            }
        }

        function przywrocPrzycisk(oknoId) {
            const $przycisk = $("#oknoprzycisk" + oknoId);
            var $blok = $("#okno" + oknoId);

            przywrocModal(oknoId);
            $przycisk.toggleClass("pasekprzyciskactive");
            toggleModal(oknoId, "minimalizujPrzycisk(" + oknoId + ")");
        }

        $(document).ready(function () {
            $(document).on('contextmenu', function (e) {
                e.preventDefault();
            });
            openModal(1, 0);
        });

        function lightMode() {
            $('body').toggleClass('light');
            showNotification();
        }

        function showNotification() {
            var notification = $("#powiadomienie");
            notification.slideDown().delay(2000).slideUp();
        }

        function fokus(oknoId) {
            zindex += 1;
            $(".pasek").addClass("pasekBlur");
            $(".okno").removeClass("oknoActive");
            if (oknoId != 0) {
                $("#okno" + oknoId).css("z-index", zindex);
                $("#okno" + oknoId +" .pasek").removeClass("pasekBlur");
                $("#okno" + oknoId).addClass("oknoActive");
            }
            else {
                $(".pasekzadan").css("z-index", zindex);
            }
        }
    </script>
</head>

<body class="">
    <div class="pasekzadan" onmousedown="fokus(0)">
        <div class="pasekprzyciski">
            <div class="pasekprzycisk pasekprzyciskactive" id="oknoprzycisk1" style="order: 1;" onclick="minimalizujPrzycisk(1)">
                🛑 Wystąpił błąd
            </div>
            <div class="pasekprzycisk" id="oknoprzycisk2" style="order: 2;" onclick="przywrocPrzycisk(2)">
                ⚙️ Ustawienia
            </div>
        </div>
        <div class="zegar">
            <span id="godzina"></span>
            <span id="data"></span>
        </div>
    </div>

    <div id="okno1" class="okno resizable" onmousedown="fokus(1)"
        style="opacity: 0; transform: scale(0.9) rotateX(20deg); pointer-events: none; display: none;">
        <div class="pasek">
            🛑 Wystąpił błąd
            <div class="przelaczniki">
                <div class="button-pasek minimalizuj" title="Minimalizuj" onclick="minimalizujModal(1)">
                    _
                </div>
                <div class="button-pasek close" title="Zamnkij" onclick="closeModal(1, 0)">
                    ⨉
                </div>
            </div>
        </div>
        <div class="content">
            <span class="ikona">🛑</span>
            Wystąpił błąd 0x0291823. Skontaktuj się z administratorem systemu.
        </div>
        <div class="przyciski">
            <div class="przycisk" onclick="closeModal(1)">
                OK
            </div>
        </div>
    </div>
    <div id="okno2" class="okno" resizable="true" onmousedown="fokus(2)"
        style="opacity: 0; transform: scale(0.9) rotateX(20deg); pointer-events: none; display: none;">
        <div class="pasek">
            ⚙️ Ustawienia
            <div class="przelaczniki">
                <div class="button-pasek minimalizuj" title="Minimalizuj" onclick="minimalizujModal(2)">
                    _
                </div>
                <div class="button-pasek close" title="Zamnkij" onclick="closeModal(2, 0)">
                    ⨉
                </div>
            </div>
        </div>
        <div class="content">
            <span class="ikona">⚙️</span>
            W tym miejscu mogą pojawić się ustawienia..
        </div>
    </div>

    <div style="display: flex; position: absolute; left: 10px; bottom: 10px;">
        <button style="color: black; margin-right: 5px;" onclick="openModal(1, 0)">otworz okno nr 1</button>
        <button style="color: black; margin-right: 5px;" onclick="openModal(2, 0)">otworz okno nr 2</button>
        <button style="color: black;" onclick="lightMode()">przełącz na dark mode / light mode</button>
    </div>

    <div id="powiadomienie" class="powiadomienie">
        Tryb jasny/ciemny został zmieniony!
    </div>

    <script>
        async function aktualizujDateGodzine() {
            var teraz = new Date();

            var godzina = teraz.getHours();
            godzina = (godzina < 10 ? "0" : "") + godzina;

            var minuta = teraz.getMinutes();
            minuta = (minuta < 10 ? "0" : "") + minuta;

            var sekunda = teraz.getSeconds();
            sekunda = (sekunda < 10 ? "0" : "") + sekunda;

            var dzien = teraz.getDate();
            dzien = (dzien < 10 ? "0" : "") + dzien;

            var miesiac = teraz.getMonth() + 1;
            miesiac = (miesiac < 10 ? "0" : "") + miesiac;

            var rok = teraz.getFullYear();

            var godzinaElement = $("#godzina");
            var dataElement = $("#data");

            godzinaElement.text(godzina + ":" + minuta + ":" + sekunda);
            dataElement.text(dzien + "." + miesiac + "." + rok);
        }

        setInterval(aktualizujDateGodzine, 1000);
        $(document).ready(function () {
            aktualizujDateGodzine();
        });
    </script>
</body>

</html>